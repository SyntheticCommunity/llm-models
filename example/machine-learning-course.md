# 机器学习方法课程培训目录


## 课程一、深度学习在基因组学应用专题

**第一天**

理论部分

深度学习算法介绍

1. 有监督学习的神经网络算法

1.1.  全连接深度神经网络DNN在基因组学中的应用举例
1.2.  卷积神经网络CNN在基因组学中的应用举例
1.3.  循环神经网络RNN在基因组学中的应用举例
1.4.  图卷积神经网络GCN在基因组学中的应用举例

2. 无监督的神经网络算法

2.1.  自动编码器AE在基因组学中的应用举例
2.2.  生成对抗网络GAN在基因组学中的应用举例

实操内容

1. Linux操作系统

1.1.  常用的Linux命令
1.2.  Vim编辑器
1.3.  基因组数据文件管理, 修改文件权限
1.4.  查看探索基因组区域

2. Python语言基础

2.1.  Python包安装和环境搭建
2.2.  常见的数据结构和数据类型

第二天

理论部分

基因组学基础

1. 基因组数据库
2. 表观基因组
3. 转录基因组
4. 蛋白质组
5. 功能基因组


实操内容

基因组常用深度学习框架

1. 安装并介绍深度学习工具包 tensorflow, keras，pytorch

2. 在工具包中识别深度学习模型要素

2.1.  数据表示
2.2.  张量运算
2.3.  神经网络中的“层”
2.4.  由层构成的模型
2.5.  损失函数与优化器
2.6.  数据集分割
2.7.  过拟合与欠拟合

3. 基因组数据处理

3.1. 安装并使用keras\_dna处理各种基因序列数据如BED、 GFF、GTF、BIGWIG、BEDGRAPH、WIG等
3.2. 使用keras\_dna设计深度学习模型
3.3. 使用keras\_dna分割训练集、测试集
3.4. 使用keras\_dna选取特定染色体的基因序列等

4．深度神经网络DNN在识别基序特征中应用

4.1. 实现单层单过滤器DNN识别基序
4.2. 实现多层单过滤器DNN识别基序
4.3. 实现多层多过滤器DNN识别基序

第三天

理论部分

卷积神经网络CNN在基因调控预测中的应用

1. Chip-Seq中识别基序特征G4，如DeepG4
2. Chip-Seq中预测DNA甲基化，DeepSEA
3. Chip-Seq中预测转录调控因子结合，DeepSEA
4. DNase-seq中预测染色体亲和性，Basset
5. DNase-seq中预测基因表达eQTL，Enformer


实操内容

复现卷积神经网络CNN识别基序特征DeepG4、非编码基因突变DeepSEA，预测染色体亲和性Basset，基因表达eQTL

1. 复现DeepG4从Chip-Seq中识别G4特征
2. 安装selene\_sdk，复现DeepSEA从Chip-Seq中预测DNA甲基化，非编码基因突变
3. 复现Basset，从Chip-Seq中预测染色体亲和性
4. 复现Enformer，从Chip-Seq中预测基因表达eQTL


第四天

理论部分

深度学习在识别拷贝数变异DeepCNV、调控因子DeepFactor上的应用

1. SNP微阵列中预测拷贝数变异CNV，DeepCNV
2. RNA-Seq中预测premiRNA，dnnMiRPre
3. 从蛋白序列中预测调控因子蛋白质，DeepFactor


实操内容

1. 复现DeepCNV利用SNP微阵列联合图像分析识别拷贝数变异
2. 复现循环神经网络RNN工具 dnnMiRPre，从RNA-Seq中预测premiRNA
3. 复现DeepFactor，从蛋白序列中识别转录调控因子蛋白质


第五天

理论部分

深度学习在识别及疾病表型及生物标志物上的应用

1. 从基因表达数据中识别乳腺癌分型的深度学习工具DeepType
2. 从高维多组学数据中识别疾病表型，XOmiVAE
3. 基因序列及蛋白质相互作用网络中识别关键基因的深度学习工具DeepHE


实操内容

1. 复现DeepType，从METABRIC乳腺癌数据中区分乳腺癌亚型
2. 复现XOmiVAE，从TCGA多维数据库中识别乳腺癌亚型
3. 复现DeepHE利用基因序列及蛋白质相互作用网络识别关键基因


第六天

理论部分

深度学习在预测药物反应机制上的应用

1. 联合肿瘤基因标记及药物分子结构预测药物反应机制的深度学习工具SWnet

实操内容

1. 预处理药物分子结构信息
2. 计算药物相似性
3. 在不同数据集上构建self-attention SWnet
4. 评估self-attention SWnet
5. 构建多任务的SWnet
6. 构建单层SWnet
7. 构建带权值层的SWnet


## 课程二、机器学习单细胞分析应用专题

第一天

理论部分

1. 单细胞测序原理
2. 单细胞测序基础
3. 单细胞测序方法及数据
4. 单细胞数据分析流程

实操内容

1. R语言基础
2. R（4.1.3）和Rstudio的安装
3. R包安装和环境搭建
4. 数据结构和数据类型
5. R语言基本函数
6. 数据下载
7. 数据读入与输出

第二天

理论部分

1. 机器学习概述
2. 线性模型
3. 决策树
4. 支持向量机
5. 集成学习
6. 模型选择与性能优化

实操内容

1. 决策树算法实现
2. 随机森林算法实现
3. 支持向量机(SVM)算法实现
4. 朴素贝叶斯算法实现
5. Xgboost算法实现
6. 主成分分析PCA算法实现
7. 聚类算法实现
8. DBSCAN算法实现
9. 层次聚类算法实现

第三天

理论部分

1. 多组学基础
2. 常用生物组学实验与分析方法
3. 常用组学数据库介绍
4. 批量处理组学数据
5. 生物功能分析
6. 基于转录组学的差异基因筛选，疾病预测
7. 基于差异基因联合多组学分析疾病发生机制
8. 组学数据可视化

实操内容

1. Linux操作系统
2. Linux操作系统的安装与设置
3. 网络配置与服务进程管理
4. Linux的远程登录管理
5. 常用的Linux命令
6. 在Linux下获取基因数据
7. 利用Linux 探索基因组区域
8. Shell script与Vim编辑器
9. 基因组文件下载与上传
10. Linux权限管理
11. 文件的身份
12. 修改文件的所有者和所属组
13. 修改文件权限

第四天

理论部分

1. 单细胞分析中的常见机器学习方法
2. 降维聚类的机器学习算法
3. 分群注释的机器学习算法
4. 单细胞分析中常见的深度学习方法
5. 降维聚类的深度学习算法
6. 分群注释的深度学习算法

实操内容

1. Python语言基础
2. python安装与开发环境的搭建
3. 基本数据类型组合数据类型
4. 分析环境搭建
5. Jupyter notebook的使用
6. 函数、列表、元组、字典、集合
7. 控制结构、循环结构
8. Numpy模块——矩阵的科学计算
9. Matplotlib模块——数据处理与绘图
10. Pandas模块——csv数据处理与分析
11. Sklearn模块——机器学习模型基础软件包调用

第五天

理论部分

1. 机器学习在单细胞分析中的应用
2. 收集数据
3. 数据准备
4. 选择一个模型
5. 模型训练
6. 模型评估
7. 参数调整
8. 模型预测

实操内容

1. 创建Seurat对象
2. 数据质控
3. 测序深度差异及标准化
4. 单细胞数据降维
5. 批次效应去除
6. 数据整合
7. 亚群注释
8. GSVA通路活性分析
9. 单细胞富集分析

第六天

理论部分

1. 深度学习在单细胞分析中的应用
2. 卷积神经网络基本构成
3. 卷积核
4. 循环神经网络基本构成
5. 循环核
6. 图神经网络基本构成

实操内容

1. 卷积神经网络在单细胞分析的算法实现
2. 循环神经网络在单细胞分析的算法实现
3. 图神经网络在单细胞中分析的算法实现
4. 单细胞数据的自动注释
5. 单细胞数据分析聚类与批量效应
6. 单细胞测序数据进行聚类
7. 加权图神经网络的细胞类型注释方法
8. 单细胞表达数据中深度学习基因关系

## 课程三、单细胞空间转录组分析专题

**第一天**

单细胞测序技术与应用

理论内容：

1. 单细胞组学研究简介
2. 单细胞转录组测序技术进展及其原理：1992\\2009-至今
3. 单细胞多组学和空间转录组技术； 
4. 单细胞转录组测序技术的常见应用和重要生物学发现； 
5. 单细胞重大项目及数据库介绍。 

实操内容： 

1. Linux 命令入门讲解及实操训练。 
2. R 语言简介及安装。 
3. R 语言简单语法及常见命令。 
4. 数据挖掘及其统计应用。 
5. R 语言实操画图 ggplot2 为主。

**第二天**

单细胞转录组数据分析思路及 流程以及数据分析实操

理论内容：

1. 单细胞实验介绍，常见建库结构。 
2. 单细胞转录组 Pipeline 软件和代码介绍。 
3. 单细胞转录组转录因子及其细胞通讯介绍。
4. 单细胞组学在肿瘤、发育、免疫及其它等领域的研究思路。 

实操内容： 

1. 10 X 官方单细胞软件 Cellranger 讲解及实操。
2. 质控基因和细胞。 
3. 选取高可变基因。
4. 降维与分群。
5. Biomarker 定义细胞类型。 
6. 寻找差异基因 
7. 通过 Seurat 合并多样本及消除样本异质性。

**第三天**

单细胞转录组轨迹、通路、转 录因子等分析及绘图实操

实操内容； 

1. 通过 Monocle 软件对单细胞转录组进行拟时序的分析。 
2. 对单细胞各个簇进行通路的功能富集分析。
3. 通过 GSVA 给细胞通路打分等。 
4. 利用 cellphonedb 软件对细胞互作进行分析。
5. 通过典型的生信软件 infercnv 对染色体拷贝数变异进行推断。 
6. 全面解析 SCENIC 软件进行转录因子预测分析。 

理论内容： 

1. 空间转录组技术的介绍。 
2. 空间转录组技术的应用。 
3. 空间转录组文章图表的解读。 
4. 空间转录组技术在癌症、发育、神经科学等领域的研究思路。

**第四天**

空间转录组数据比对、降维以 及聚类等分析 空间转录组多样本及与但单细 胞数据关联分析

实操内容： 

1. 10 x Visium 组织优化及文库制备。
2. 10 x Visium 官方分析软件 Space Ranger 讲解及实操。 
3. Space Ranger 输出结果解读。 
4. Loupe Browser 软件安装及使用。 
5. 通过 Seurat 软件进行降维、聚类和可视化。
6. 通过 Seurat 进行基因表达可视化。 

理论+实操内容

1. 通过 Seurat 进行空间变量特征的识别。 
2. 与单细胞数据关联分析（空间细胞类型定义）
3. 通过 Seurat 处理多个切片。 
4. 单细胞及空间转录组数据分析总结。



## 课程四、机器学习蛋白组学



**第一天**

机器学习及蛋白组学简介

1. 机器学习基本概念介绍
2. 常用机器学习模型介绍
3. 混淆矩阵
4. ROC曲线
5. 主成分分析（PCA）
6. 蛋白组学基本概念

R语言简介及实操

1．R语言概述
2．R软件及R包安装
3．R语言语法及数据类型
4．条件语句
5．循环
6．函数
7．常用的机器学习相关R包介绍


**第二天**

机器学习在蛋白组学数据分析中的应用案例分享

1. 利用机器学习鉴定疾病相关蛋白标志物
2. 利用机器学习基于蛋白组学数据预测表型
3. 利用机器学习基于蛋白组学数据进行分类
4. 利用机器学习基于蛋白组学数据构建预后模型

蛋白组学相关数据库介绍

1. Uniport
2. HPA
3. TCPA
4. CPTAC

**第三天**

零代码工具利用机器学习分析蛋白组学数据

利用 PLOS Computational Biology（IF:5分）发表零代码工具，轻松完成差异表达分析，常见统计分析，常见可视化，内置7种机器学习方法，轻松调用。

1. 数据导入（两套数据，二分类，多分类）
2. 数据可视化（散点图，热图，柱形图，相关性热图，火山图，层次聚类图）
3. 缺失值填充
4. 数据归一化
5. 离群值检测/清理
6. 常见统计方法应用（t-test, limma, Kruskal-Wallis ,ANOVA, PCA, k-means, 相关性分析）
7. 机器学习方法应用（RF, lasso, SVM等）

**第四天**

利用机器学习基于蛋白组学数据预测表型，基于蛋白组学数据复现cell中机器学习分析结果

实操内容

1. 蛋白组学数据处理，差异表达分析
2. 火山图，多分组热图，多组箱型图展示差异表达分析结果
3. 构建Random Forest模型
4. 重要蛋白筛选
5. 绘制ROC曲线
6. 独立测试集检测模型表现

利用机器学习鉴定疾病相关蛋白标志物，基于Olink数据，复现影响因子17分文章中，蛋白数据常规分析+时序蛋白聚类分析+机器学习分析结果

实操内容

1. 读取蛋白表达数据
2. 差异蛋白挑选，火山图绘制，箱型图绘制
3. 时序蛋白表达数据聚类分析
4. 构建随机森林模型
5. 挑选重要特征
6. 独立测试集进行验证


**第五天**

利用机器学习基于质谱的蛋白质组学数据，构建肝病相关分类和预后模型，复现Nature Medicine文章中的机器学习，生存分析，预后模型相关的结果。


实操内容

1. 鉴定与不同肝病显著相关的蛋白
2. 比较22种不同的机器学习分类器，挑选最优算法构建不同肝病的分类模型
3. 独立队列验证模型准确性
4. 构建预后模型
5. 绘制生存曲线和时间依赖的ROC曲线



## 课程五、机器学习微生物组学 

**第一天**

机器学习及微生物学简介

1. 机器学习基本概念介绍
2. 常用机器学习模型介绍（GLM,BF,SVM,lasso,KNN等等）
3. 混淆矩阵
4. ROC曲线
5. 主成分分析（PCA）
6. 微生物学基本概念
7. 微生物学常用分析介绍

R语言简介及实操

1. R语言概述
2. R软件及R包安装
3. R语言语法及数据类型
4. 条件语句
5. 循环

**第二天**

机器学习在微生物学中的应用案例分享

1. 利用机器学习基于微生物组学数据预测宿主表
2. 利用机器学习基于微生物组学数据预测疾病状态
3. 利用机器学习预测微生物风险
4. 机器学习研究饮食对肠道微生物的影响

微生物学常用分析（实操）

1. 微生物丰度分析
2. α-diversity，β-diversity分析
3. 进化树构建
4. 降维分析
5. 基于OTU的差异表达分析，热图，箱型图绘制微生物biomarker鉴定


第三天：（实操）

零代码工具利用机器学习分析微生物组学数据

1. 加载数据及数据归一化 
2. 构建训练模型（GLM, RF, SVM） 
3. 模型参数优化 
4. 模型错误率曲线绘制 
5. 混淆矩阵计算 
6. 重要特征筛选 
7. 模型验证，ROC曲线绘制利用模型进行预测 


**第四天（实操）**

利用机器学习基于微生物组学数据预测宿主表型(二分类变量以及连续变量)

1. 加载数据（三套数据）
2. 数据归一化 
3. OUT特征处理 
4. 机器学习模型构建（RF, KNN, SVM, Lasso等9种机器学习方法） 
5. 5倍 交叉验证 
6. 绘制ROC 曲线，比较不同机器学习模型模型性能评估

**第五天（实操）**

利用机器学习预测微生物风险（多分类）


1. 加载数据
2. 机器学习模型构建（RF, gbm, SVM, LogitBoost等等） 
3. 10 倍交叉验证 
4. 模型性能评估 

利用机器学习预测刺激前后肠道菌群变化 

1. 数据加载及预处理 
2. α-diversity，β-diversity分析 
3. RF模型构建（比较分别基于OUT，KO，phylum的模型效果） 
4. 10 倍交叉验证, 留一法验证 
5. 特征筛选及重要特征可视化外部数据测试模型

## 课程六、机器学习与代谢组学 

**第一天**

A1 代谢物及代谢组学的发展与应用

（1） 代谢生理功能； 
（2） 代谢疾病；
（3） 非靶向与靶向代谢组学；
（4） 空间代谢组学与质谱成像（MSI）；
（5） 代谢流与机制研究；
（6） 代谢组学与药物和生物标志物。

A2 代谢组学实验流程简介

A3 色谱、质谱硬件原理

（1） 色谱分析原理；
（2） 色谱的气相、液相和固相；
（3） 色谱仪和色谱柱的选择；
（4） 质谱分析原理及动画演示；
（5） 正、负离子电离模式；
（6） 色谱质谱联用技术；
（7） LC-MS 的液相系统

A4 代谢通路及代谢数据库

（1） 几种经典代谢通路简介；
（2） 能量代谢通路；
（3） 三大常见代谢物库：HMDB、METLIN 和 KEGG;
（4） 代谢组学原始数据库：Metabolomics Workbench 和Metabolights.

**第二天**

B1 代谢物样本处理与抽提

（1） 组织、血液和体液样本的提取流程与注意事项；
（2） 用 ACN 抽提代谢物的流程与注意事项；
（3） 样本及代谢物的运输与保存问题；

B2 LC-MS 数据质控与搜库

（1） LC-MS 实验过程中 QC 样本的设置方法；
（2） LC-MS 上机过程的数据质控监测和分析；
（3） XCMS 软件数据转换与提峰；

B3 R 软件基础

（1） R 和 Rstudio 的安装；
（2） Rstudio 的界面配置；
（3） R 的基本数据结构和语法；
（4） 下载与加载包；
（5） 函数调用和 debug；

B4 ggplot2

（1） 安装并使用 ggplot2
（2） ggplot2 的画图哲学；
（3） ggplot2 的配色系统；
（4） ggplot2 画组合图和火山图；


**第三天**

机器学习

C1 无监督式机器学习在代谢组学数据处理中的应用

（1） 大数据处理中的降维；
（2） PCA 分析作图；
（3） 三种常见的聚类分析：K-means、层次分析与 SOM
（4） 热图和 hcluster 图的 R 语言实现；

C2 一组代谢组学数据的降维与聚类分析的 R 演练

(1) 数据解析；
(2) 演练与操作；

C3 有监督式机器学习在代谢组学数据处理中的应用

（1） 数据用 PCA 降维处理后仍然无法找到差异怎么办？
（2） PLS-DA 找出最可能影响差异的代谢物；
（3） VIP score 和 coef 的意义及选择；
（4） 分类算法：支持向量机，随机森林

C4 一组代谢组学数据的分类算法实现的 R 演练

(1) 数据解读；
(2) 演练与操作；

**第四天**

D1 代谢组学数据清洗与 R 语言进阶

（1） 代谢组学中的 t、fold-change 和响应值； 
（2） 数据清洗流程；
（3） R 语言 tidyverse
（4） R 语言正则表达式；
（5） 代谢组学数据过滤；
（6） 代谢组学数据 Scaling 原理与 R 实现；
（7） 代谢组学数据的 Normalization；
（8） 代谢组学数据清洗演练；

D2 在线代谢组分析网页 Metaboanalyst 操作

（1） 用 R 将数据清洗成网页需要的格式；
（2） 独立组、配对组和多组的数据格式问题；
（3） Metaboanalyst 的 pipeline 和注意事项；
（4） Metaboanalyst 的结果查看和导出；
（5） Metaboanalyst 的数据编辑；
（6） 全流程演练与操作

**第五天**

E1 机器学习与代谢组学顶刊解读（2-3 篇）

（1） Nature Communication 一篇代谢组学小鼠脑组织样本 database 类型的文献； 
（2） Cell 一篇代谢组学患者血液样本的机器学习与疾病判断的文献； 
（3） 1- 2 篇代谢组学与转录组学和蛋白组学结合的文献。 

E2 文献数据分析部分复现（1 篇） 

（1） 文献深度解读； 
（2） 实操：从原始数据下载到图片复现； 
（3） 学员实操。
